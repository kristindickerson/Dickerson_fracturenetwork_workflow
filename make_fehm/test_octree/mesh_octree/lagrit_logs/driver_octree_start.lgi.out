 
 
*               * * * * * * * * * * * * * * * * * * * * * * * *                 
*               *                                             *                 
*               *    Program:  LaGriT V3.3.4   Darwin         *                 
*               *    Compiler Name: AppleClang                *                 
*               *    Compiler Version: 14.0.0.14000029        *                 
*               *    Date Compile: 2024/10/22                 *                 
*               *    Run Time: 2024/Dec 17  16:42:19          *                 
*               *    Manual:   https://lagrit.lanl.gov        *                 
*               *                                             *                 
*               * * * * * * * * * * * * * * * * * * * * * * * *                 
 
                               -----oOo-----                                    
             LaGriT V3 LA-CC-15-069  https://github.com/lanl/LaGriT             
  Copyright 2016. Triad National Security, LLC.  All rights reserved. This      
  program was produced under U.S. Government contract 89233218CNA000001         
  for Los Alamos National Laboratory (LANL), which is operated by Triad         
  National Security, LLC for the U.S. Department of Energy/National Nuclear     
  Security Administration.  All rights in the program are reserved by Triad     
  National Security, LLC, and the U.S. Department of Energy/National Nuclear    
  Security Administration. The Government is granted for itself and others      
  acting on its behalf a nonexclusive, paid-up, irrevocable worldwide license   
  in this material to reproduce, prepare derivative works, distribute copies    
  to the public, perform publicly and display publicly, and to permit others to 
  do so. This software is open source and available under the BSD-3 License.    
                               -----oOo-----                                    
 
 
Output log file: driver_octree_start.lgi.out                                    
Command log file: driver_octree_start.lgi.log                                   
 
#                                                                               
# LaGriT control files to build an octree refined hex mesh with refinement      
# based on intersection of hex mesh with a DFN triangulation mesh               
#                                                                               
# driver_octree.lgi                                                             
#   parameters_octree_dfn.mlgi                                                  
#   build_octree.mlgi                                                           
#       intersect_refine.mlgi                                                   
#   hex_to_tet.mlgi                                                             
#   remove_cells.mlgi                                                           
#                                                                               
# Define some parameters                                                        
#                                                                               
infile parameters_octree_dfn.mlgi                                               
#                                                                               
# Define some parameters                                                        
#                                                                               
# Input DFN mesh                                                                
#                                                                               
define/FTYPE/avs                                                                
define/FNAME/reduced_mesh.inp                                                   
#                                                                               
define/MOHEX/mohex                                                              
define/MOTET/motet                                                              
#                                                                               
# Set AMR refinement. 123 means refine in x,y,z directions                      
# See LaGriT refine command for more options                                    
#                                                                               
define/REFINE_AMR/123                                                           
#                                                                               
define/N_OCTREE_REFINE/2                                                        
define/N_OCTREE_REFINE_M1/1                                                     
define/N_OCTREE_np1/3                                                           
define/N_OCTREE_np1_M1/2                                                        
define/X0/-5000.000000000000                                                    
define/X1/5000.000000000000                                                     
define/Y0/-5000.000000000000                                                    
define/Y1/5000.000000000000                                                     
define/Z0/-5000.000000000000                                                    
define/Z1/5000.000000000000                                                     
define/XMAX/4999.000000000000                                                   
define/XMIN/-4999.000000000000                                                  
define/YMAX/4999.000000000000                                                   
define/YMIN/-4999.000000000000                                                  
define/ZMAX/4999.000000000000                                                   
define/ZMIN/-4999.000000000000                                                  
define/NX/11                                                                    
define/NY/11                                                                    
define/NZ/11                                                                    
finish                                                                          
#                                                                               
# Read in DFN mesh                                                              
#                                                                               
read/FTYPE/FNAME/MODFN                                                          
cmo/addatt/MODFN/family_id/VINT/scalar/nelements/linear/permanent/gxaf/0.0      
finish                                                                          
geniee                                                                          
finish                                                                          
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: MODFN                                          
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                   active    
 
 
finish                                                                          
cmo/printatt/MODFN/-xyz-/minmax                                                 
ATTRIBUTE NAME              MIN               MAX         DIFFERENCE    LENGTH  
 xic               -5.000000000E+03  5.000000000E+03 1.000000000E+04       406  
 yic               -5.000000000E+03  5.000000000E+03 1.000000000E+04       406  
 zic                7.163772723E+02  7.283622728E+03 6.567245455E+03       406  
 
#                                                                               
# Octree refined orthogonal mesh based on intersection with DFN mesh            
#                                                                               
infile build_octree.mlgi                                                        
cmo/create/MOHEX///hex                                                          
createpts/brick/xyz/NX NY NZ/X0 Y0 Z0/X1 Y1 Z1/1 1 1                            
          Number of nodes:        1331                                          
          Number of elements:        1000                                       
          Number of negative volume elements:           0                       
          Total volume:     0.100000000000E+13                                  
cmo/setatt/MOHEX/imt/1 0 0/1                                                    
      1331 values reset for attribute imt1                                      
 
cmo/setatt/MOHEX/itetclr/1 0 0/1                                                
      1000 values reset for attribute itetclr                                   
 
resetpts/itp                                                                    
geniee                                                                          
finish                                                                          
#                                                                               
# Print to screen and logfiles the extents of the hex mesh and dfn mesh         
#                                                                               
cmo/printatt/MOHEX/-xyz-/minmax                                                 
ATTRIBUTE NAME              MIN               MAX         DIFFERENCE    LENGTH  
 xic               -5.000000000E+03  5.000000000E+03 1.000000000E+04      1331  
 yic               -5.000000000E+03  5.000000000E+03 1.000000000E+04      1331  
 zic               -5.000000000E+03  5.000000000E+03 1.000000000E+04      1331  
 
cmo/select/MODFN                                                                
cmo/printatt/MODFN/-xyz-/minmax                                                 
ATTRIBUTE NAME              MIN               MAX         DIFFERENCE    LENGTH  
 xic               -5.000000000E+03  5.000000000E+03 1.000000000E+04       406  
 yic               -5.000000000E+03  5.000000000E+03 1.000000000E+04       406  
 zic                7.163772723E+02  7.283622728E+03 6.567245455E+03       406  
 
#                                                                               
# Generate copy of hex mesh for upscaling                                       
#                                                                               
cmo/copy/MOHEX_np1/MOHEX                                                        
#                                                                               
# Loop through steps to intersect dfn mesh (MODFN) with hex mesh (MOHEX)        
# and refine hex mesh based on cell intersections. Loop through                 
# N_OCTREE_REFINE times                                                         
#                                                                               
loop/do/NTIMEs/1 N_OCTREE_REFINE 1/loop_end infile intersect_refine.mlgi        
LOOP: loop nesting level =     1                                                
define/NTIMEs/1                                                                 
finish                                                                          
infile intersect_refine.mlgi                                                    
#                                                                               
# Compute mesh to mesh intersection and refine hex mesh                         
#                                                                               
intersect_elements/MOHEX/MODFN/if_int                                           
cmo/select/mohex                                                                
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/mohex/if_int/VINT/scalar/nelements/linear/permanent//0/              
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             76             1251            409       25 %                      
            151             1596             11       50 %                      
            226             2017             16       75 %                      
            298             2678            451    Total Done                   
 
cmo/select/mohex                                                                
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/mohex/sbox                                                           
finish                                                                          
cmo/DELATT/mohex/v12                                                            
finish                                                                          
cmo/DELATT/mohex/linkt                                                          
finish                                                                          
cmo/DELATT/mohex/v2                                                             
finish                                                                          
finish                                                                          
eltset/erefine/if_int/ne/0                                                      
 
 THE ELTSET erefine                          HAS        451 ELEMENTS            
pset/prefine/eltset erefine                                                     
 
 THE PSET  prefine  HAS        726 POINTS                                       
#                                                                               
# If one wants anisotropic mesh refinement, then the                            
# variable REFINE_AMR can be set in parameters_octree_dfn.mlgi                  
#                                                                               
refine/constant/imt1/linear/element/pset,get,prefine/-1.,0.,0./exclusive/amr REF
INE_AMR                                                                         
refine elements:                                                                
refine hex     :        500                                                     
cmo/addatt/mohex/itetpar/VINT/scalar/nelements/linear/permanent//0.0            
finish                                                                          
cmo/addatt/mohex/itetkid/VINT/scalar/nelements/linear/permanent//0.0            
finish                                                                          
cmo/addatt/mohex/itetlev/VINT/scalar/nelements/linear/permanent//0.0            
finish                                                                          
cmo/addatt/mohex/xradavg/VDOUBLE/scalar/nnodes/linear/temporary//0.0            
finish                                                                          
Element iteration:          1       500                                         
Octree(PRD) refined elems: old=      1000 new=      5000                        
FILTER_SUBSET:Dudding duplicate points:        5375                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
cmo/DELATT/mohex/xradavg                                                        
finish                                                                          
#                                                                               
# Clean up eltset, pset, and if_int attribute                                   
#                                                                               
eltset/erefine/delete                                                           
 
 ELTSET erefine                          DELETED                                
 
pset/prefine/delete                                                             
 
 PSET prefine  DELETED                                                          
 
cmo/DELATT/MOHEX/if_int                                                         
#                                                                               
# Print out diagnostics                                                         
#                                                                               
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :       5000                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:         0                      
element volumes b/w  0.3981E+07 and  0.1585E+08:         0                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      4000                      
element volumes b/w  0.2512E+09 and  0.1000E+10:      1000                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
      5000 total elements evaluated.                                            
 
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: mohex                                          
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                 inactive    
 
  2 Mesh Object name: mohex                                                     
    number of nodes =         10831        number of elements =         5000    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                   active    
 
  3 Mesh Object name: MOHEX_np1                                                 
    number of nodes =          1331        number of elements =         1000    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                 inactive    
 
 
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/2                                                                 
finish                                                                          
infile intersect_refine.mlgi                                                    
#                                                                               
# Compute mesh to mesh intersection and refine hex mesh                         
#                                                                               
intersect_elements/MOHEX/MODFN/if_int                                           
cmo/select/mohex                                                                
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/mohex/if_int/VINT/scalar/nelements/linear/permanent//0/              
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             76             6105           1626       25 %                      
            151             6915             38       50 %                      
            226             8034             65       75 %                      
            298            10634           1909    Total Done                   
 
cmo/select/mohex                                                                
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/mohex/sbox                                                           
finish                                                                          
cmo/DELATT/mohex/v12                                                            
finish                                                                          
cmo/DELATT/mohex/linkt                                                          
finish                                                                          
cmo/DELATT/mohex/v2                                                             
finish                                                                          
finish                                                                          
eltset/erefine/if_int/ne/0                                                      
 
 THE ELTSET erefine                          HAS       1909 ELEMENTS            
pset/prefine/eltset erefine                                                     
 
 THE PSET  prefine  HAS       3288 POINTS                                       
#                                                                               
# If one wants anisotropic mesh refinement, then the                            
# variable REFINE_AMR can be set in parameters_octree_dfn.mlgi                  
#                                                                               
refine/constant/imt1/linear/element/pset,get,prefine/-1.,0.,0./exclusive/amr REF
INE_AMR                                                                         
refine elements:                                                                
refine hex     :       2038                                                     
cmo/addatt/mohex/xradavg/VDOUBLE/scalar/nnodes/linear/temporary//0.0            
finish                                                                          
Element iteration:          1      2017                                         
Octree(PRD) refined elems: old=      5000 new=     21136                        
FILTER_SUBSET:Dudding duplicate points:       20502                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
cmo/DELATT/mohex/xradavg                                                        
finish                                                                          
#                                                                               
# Clean up eltset, pset, and if_int attribute                                   
#                                                                               
eltset/erefine/delete                                                           
 
 ELTSET erefine                          DELETED                                
 
pset/prefine/delete                                                             
 
 PSET prefine  DELETED                                                          
 
cmo/DELATT/MOHEX/if_int                                                         
#                                                                               
# Print out diagnostics                                                         
#                                                                               
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :      21136                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:         0                      
element volumes b/w  0.3981E+07 and  0.1585E+08:     16136                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      4000                      
element volumes b/w  0.2512E+09 and  0.1000E+10:      1000                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
     21136 total elements evaluated.                                            
 
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: mohex                                          
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                 inactive    
 
  2 Mesh Object name: mohex                                                     
    number of nodes =         49154        number of elements =        21136    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                   active    
 
  3 Mesh Object name: MOHEX_np1                                                 
    number of nodes =          1331        number of elements =         1000    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                 inactive    
 
 
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/remove                                                            
finish                                                                          
#                                                                               
# See above - except do it once additional time ("np1")                         
#                                                                               
loop/do/NTIMEs/1 N_OCTREE_np1 1/loop_end infile intersect_refine_np1.mlgi       
LOOP: loop nesting level =     1                                                
define/NTIMEs/1                                                                 
finish                                                                          
infile intersect_refine_np1.mlgi                                                
#                                                                               
# For comments see intersect_refine.mlgi                                        
#                                                                               
intersect_elements/MOHEX_np1/MODFN/if_int                                       
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/MOHEX_np1/if_int/VINT/scalar/nelements/linear/permanent//0/          
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             76             1251            409       25 %                      
            151             1596             11       50 %                      
            226             2017             16       75 %                      
            298             2678            451    Total Done                   
 
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/MOHEX_np1/sbox                                                       
finish                                                                          
cmo/DELATT/MOHEX_np1/v12                                                        
finish                                                                          
cmo/DELATT/MOHEX_np1/linkt                                                      
finish                                                                          
cmo/DELATT/MOHEX_np1/v2                                                         
finish                                                                          
finish                                                                          
eltset/erefine/if_int/ne/0                                                      
 
 THE ELTSET erefine                          HAS        451 ELEMENTS            
pset/prefine/eltset erefine                                                     
 
 THE PSET  prefine  HAS        726 POINTS                                       
refine/constant/imt1/linear/element/pset,get,prefine/-1.,0.,0./exclusive/amr REF
INE_AMR                                                                         
refine elements:                                                                
refine hex     :        500                                                     
cmo/addatt/MOHEX_np1/itetpar/VINT/scalar/nelements/linear/permanent//0.0        
finish                                                                          
cmo/addatt/MOHEX_np1/itetkid/VINT/scalar/nelements/linear/permanent//0.0        
finish                                                                          
cmo/addatt/MOHEX_np1/itetlev/VINT/scalar/nelements/linear/permanent//0.0        
finish                                                                          
cmo/addatt/MOHEX_np1/xradavg/VDOUBLE/scalar/nnodes/linear/temporary//0.0        
finish                                                                          
Element iteration:          1       500                                         
Octree(PRD) refined elems: old=      1000 new=      5000                        
FILTER_SUBSET:Dudding duplicate points:        5375                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
cmo/DELATT/MOHEX_np1/xradavg                                                    
finish                                                                          
#                                                                               
eltset/erefine/delete                                                           
 
 ELTSET erefine                          DELETED                                
 
pset/prefine/delete                                                             
 
 PSET prefine  DELETED                                                          
 
cmo/DELATT/MOHEX_np1/if_int                                                     
#                                                                               
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :       5000                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:         0                      
element volumes b/w  0.3981E+07 and  0.1585E+08:         0                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      4000                      
element volumes b/w  0.2512E+09 and  0.1000E+10:      1000                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
      5000 total elements evaluated.                                            
 
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: MOHEX_np1                                      
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                 inactive    
 
  2 Mesh Object name: mohex                                                     
    number of nodes =         49154        number of elements =        21136    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                 inactive    
 
  3 Mesh Object name: MOHEX_np1                                                 
    number of nodes =         10831        number of elements =         5000    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                   active    
 
 
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/2                                                                 
finish                                                                          
infile intersect_refine_np1.mlgi                                                
#                                                                               
# For comments see intersect_refine.mlgi                                        
#                                                                               
intersect_elements/MOHEX_np1/MODFN/if_int                                       
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/MOHEX_np1/if_int/VINT/scalar/nelements/linear/permanent//0/          
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             76             6105           1626       25 %                      
            151             6915             38       50 %                      
            226             8034             65       75 %                      
            298            10634           1909    Total Done                   
 
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/MOHEX_np1/sbox                                                       
finish                                                                          
cmo/DELATT/MOHEX_np1/v12                                                        
finish                                                                          
cmo/DELATT/MOHEX_np1/linkt                                                      
finish                                                                          
cmo/DELATT/MOHEX_np1/v2                                                         
finish                                                                          
finish                                                                          
eltset/erefine/if_int/ne/0                                                      
 
 THE ELTSET erefine                          HAS       1909 ELEMENTS            
pset/prefine/eltset erefine                                                     
 
 THE PSET  prefine  HAS       3288 POINTS                                       
refine/constant/imt1/linear/element/pset,get,prefine/-1.,0.,0./exclusive/amr REF
INE_AMR                                                                         
refine elements:                                                                
refine hex     :       2038                                                     
cmo/addatt/MOHEX_np1/xradavg/VDOUBLE/scalar/nnodes/linear/temporary//0.0        
finish                                                                          
Element iteration:          1      2017                                         
Octree(PRD) refined elems: old=      5000 new=     21136                        
FILTER_SUBSET:Dudding duplicate points:       20502                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
cmo/DELATT/MOHEX_np1/xradavg                                                    
finish                                                                          
#                                                                               
eltset/erefine/delete                                                           
 
 ELTSET erefine                          DELETED                                
 
pset/prefine/delete                                                             
 
 PSET prefine  DELETED                                                          
 
cmo/DELATT/MOHEX_np1/if_int                                                     
#                                                                               
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :      21136                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:         0                      
element volumes b/w  0.3981E+07 and  0.1585E+08:     16136                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      4000                      
element volumes b/w  0.2512E+09 and  0.1000E+10:      1000                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
     21136 total elements evaluated.                                            
 
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: MOHEX_np1                                      
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                 inactive    
 
  2 Mesh Object name: mohex                                                     
    number of nodes =         49154        number of elements =        21136    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                 inactive    
 
  3 Mesh Object name: MOHEX_np1                                                 
    number of nodes =         49154        number of elements =        21136    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                   active    
 
 
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/3                                                                 
finish                                                                          
infile intersect_refine_np1.mlgi                                                
#                                                                               
# For comments see intersect_refine.mlgi                                        
#                                                                               
intersect_elements/MOHEX_np1/MODFN/if_int                                       
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/MOHEX_np1/if_int/VINT/scalar/nelements/linear/permanent//0/          
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             16            21284           6412        5 %                      
             31            21561             21       10 %                      
             46            21742              6       15 %                      
             61            22018              9       20 %                      
             76            22628             33       25 %                      
             91            22904             11       30 %                      
            106            23310             13       35 %                      
            121            23496             12       40 %                      
            136            24122             39       45 %                      
            151            24330             14       50 %                      
            166            24857             31       55 %                      
            181            25999            103       60 %                      
            196            26495             33       65 %                      
            211            26787             10       70 %                      
            226            27180             24       75 %                      
            241            27573             22       80 %                      
            256            27906             30       85 %                      
            271            28192             23       90 %                      
            286            28956             47       95 %                      
            298            37983           7735    Total Done                   
 
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/MOHEX_np1/sbox                                                       
finish                                                                          
cmo/DELATT/MOHEX_np1/v12                                                        
finish                                                                          
cmo/DELATT/MOHEX_np1/linkt                                                      
finish                                                                          
cmo/DELATT/MOHEX_np1/v2                                                         
finish                                                                          
finish                                                                          
eltset/erefine/if_int/ne/0                                                      
 
 THE ELTSET erefine                          HAS       7735 ELEMENTS            
pset/prefine/eltset erefine                                                     
 
 THE PSET  prefine  HAS      12964 POINTS                                       
refine/constant/imt1/linear/element/pset,get,prefine/-1.,0.,0./exclusive/amr REF
INE_AMR                                                                         
refine elements:                                                                
refine hex     :       7845                                                     
cmo/addatt/MOHEX_np1/xradavg/VDOUBLE/scalar/nnodes/linear/temporary//0.0        
finish                                                                          
Element iteration:          1      7818                                         
Octree(PRD) refined elems: old=     21136 new=     83680                        
FILTER_SUBSET:Dudding duplicate points:       79022                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
Element iteration:          1       266                                         
Octree(PRD) refined elems: old=     83680 new=     85808                        
FILTER_SUBSET:Dudding duplicate points:        2904                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:          26                                    
geniee                                                                          
finish                                                                          
Element iteration:          1         2                                         
Octree(PRD) refined elems: old=     85808 new=     85824                        
FILTER_SUBSET:Dudding duplicate points:          10                             
 
filter/1,0,0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
geniee                                                                          
finish                                                                          
cmo/DELATT/MOHEX_np1/xradavg                                                    
finish                                                                          
#                                                                               
eltset/erefine/delete                                                           
 
 ELTSET erefine                          DELETED                                
 
pset/prefine/delete                                                             
 
 PSET prefine  DELETED                                                          
 
cmo/DELATT/MOHEX_np1/if_int                                                     
#                                                                               
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :      85824                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:     62544                      
element volumes b/w  0.3981E+07 and  0.1585E+08:     18264                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      4016                      
element volumes b/w  0.2512E+09 and  0.1000E+10:      1000                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
     85824 total elements evaluated.                                            
 
cmo/status/brief                                                                
 
The current-mesh-object(CMO) is: MOHEX_np1                                      
 
  1 Mesh Object name: MODFN                                                     
    number of nodes =           406        number of elements =          298    
    dimensions geometry =         3        element type =                tri    
    dimensions topology =         2        3 nodes      3 faces      3 edges    
    boundary flag =        16000000        status =                 inactive    
 
  2 Mesh Object name: mohex                                                     
    number of nodes =         49154        number of elements =        21136    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                 inactive    
 
  3 Mesh Object name: MOHEX_np1                                                 
    number of nodes =        202788        number of elements =        85824    
    dimensions geometry =         3        element type =                hex    
    dimensions topology =         3        8 nodes      6 faces     12 edges    
    boundary flag =        16000000        status =                   active    
 
 
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/remove                                                            
finish                                                                          
#                                                                               
finish                                                                          
#                                                                               
# Identify cells in hex mesh that are intersected by DFN mesh                   
#                                                                               
# This is the last pass through intersect_elements in order to figure out       
# which cells in the fully refined hex mesh are intersected by the dfn mesh     
#                                                                               
intersect_elements/MOHEX/MODFN/if_int                                           
cmo/select/mohex                                                                
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/mohex/if_int/VINT/scalar/nelements/linear/permanent//0/              
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             16            21284           6412        5 %                      
             31            21561             21       10 %                      
             46            21742              6       15 %                      
             61            22018              9       20 %                      
             76            22628             33       25 %                      
             91            22904             11       30 %                      
            106            23310             13       35 %                      
            121            23496             12       40 %                      
            136            24122             39       45 %                      
            151            24330             14       50 %                      
            166            24857             31       55 %                      
            181            25999            103       60 %                      
            196            26495             33       65 %                      
            211            26787             10       70 %                      
            226            27180             24       75 %                      
            241            27573             22       80 %                      
            256            27906             30       85 %                      
            271            28192             23       90 %                      
            286            28956             47       95 %                      
            298            37983           7735    Total Done                   
 
cmo/select/mohex                                                                
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/mohex/sbox                                                           
finish                                                                          
cmo/DELATT/mohex/v12                                                            
finish                                                                          
cmo/DELATT/mohex/linkt                                                          
finish                                                                          
cmo/DELATT/mohex/v2                                                             
finish                                                                          
finish                                                                          
eltset/einter/if_int/ne/0                                                       
 
 THE ELTSET einter                           HAS       7735 ELEMENTS            
pset/pinter/eltset einter                                                       
 
 THE PSET  pinter  HAS      12964 POINTS                                        
#                                                                               
# Use the itetclr(cell) and imt(vertex) attribute to hold the information       
#                                                                               
cmo/setatt/MOHEX/itetclr/1 0 0/1                                                
     21136 values reset for attribute itetclr                                   
 
cmo/setatt/MOHEX/itetclr/eltset get einter/2                                    
      7735 values reset for attribute itetclr                                   
 
cmo/setatt/MOHEX/imt/1 0 0/1                                                    
     23277 values reset for attribute imt1                                      
 
cmo/setatt/MOHEX/imt/pset get pinter/2                                          
     12964 values reset for attribute imt1                                      
 
#                                                                               
# Output final hex mesh                                                         
#                                                                               
#dump / avs2 / tmp_hex_refine.inp / MOHEX                                       
#                                                                               
# Same as above but for np1 hex mesh                                            
#                                                                               
intersect_elements/MOHEX_np1/MODFN/if_int                                       
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/MOHEX_np1/if_int/VINT/scalar/nelements/linear/permanent//0/          
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             16            85783          25635        5 %                      
             31            86428             59       10 %                      
             46            86714             18       15 %                      
             61            87215             31       20 %                      
             76            89114            119       25 %                      
             91            89593             25       30 %                      
            106            90444             41       35 %                      
            121            90963             41       40 %                      
            136            92301            128       45 %                      
            151            92910             40       50 %                      
            166            94047             87       55 %                      
            181            97334            356       60 %                      
            196            98818            109       65 %                      
            211            99377             33       70 %                      
            226           100368             87       75 %                      
            241           101452             86       80 %                      
            256           102426             84       85 %                      
            271           103077             55       90 %                      
            286           105279            181       95 %                      
            298           141101          30853    Total Done                   
 
cmo/select/MOHEX_np1                                                            
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/MOHEX_np1/sbox                                                       
finish                                                                          
cmo/DELATT/MOHEX_np1/v12                                                        
finish                                                                          
cmo/DELATT/MOHEX_np1/linkt                                                      
finish                                                                          
cmo/DELATT/MOHEX_np1/v2                                                         
finish                                                                          
finish                                                                          
eltset/einter/if_int/ne/0                                                       
 
 THE ELTSET einter                           HAS      30853 ELEMENTS            
pset/pinter/eltset einter                                                       
 
 THE PSET  pinter  HAS      50285 POINTS                                        
#                                                                               
# See above                                                                     
#                                                                               
cmo/setatt/MOHEX_np1/itetclr/1 0 0/1                                            
     85824 values reset for attribute itetclr                                   
 
cmo/setatt/MOHEX_np1/itetclr/eltset get einter/2                                
     30853 values reset for attribute itetclr                                   
 
cmo/setatt/MOHEX_np1/imt/1 0 0/1                                                
     94949 values reset for attribute imt1                                      
 
cmo/setatt/MOHEX_np1/imt/pset get pinter/2                                      
     50285 values reset for attribute imt1                                      
 
#dump / avs2 / tmp_hex_np1_refine.inp / MOHEX_np1                               
#                                                                               
# Convert the hex mesh to a tet mesh                                            
#                                                                               
infile hex_to_tet.mlgi                                                          
#                                                                               
# Convert the octree hex mesh to tet mesh by connecting the                     
# octree vertex collection to a Delaunay mesh                                   
#                                                                               
cmo/create/MOTET                                                                
copypts/MOTET/MOHEX                                                             
copypts added nodes          1 to      23277                                    
cmo/select/MOTET                                                                
filter 1 0 0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
rmpoint/compress                                                                
         0 points removed and          0 elements removed.                      
RMPOINT: new point count is        23277                                        
RMPOINT: new element count is          0                                        
cmo/setatt/MOTET/imt/1 0 0/1                                                    
Warning: nelements = 0                                                          
     23277 values reset for attribute imt1                                      
 
cmo/setatt/MOTET/itp/1 0 0/0                                                    
Warning: nelements = 0                                                          
     23277 values reset for attribute itp1                                      
 
#                                                                               
# Sort and reorder the nodes based on coordinates                               
#                                                                               
sort/MOTET/index/ascending/ikey/xic yic zic                                     
cmo/addatt/motet/ikey/vint/scalar/nnodes///gax/0                                
finish                                                                          
 SORT: order key written to attribute: ikey                                     
 
reorder/MOTET/ikey                                                              
cmo/DELATT/MOTET/ikey                                                           
#                                                                               
# Connect                                                                       
#                                                                               
connect/noadd                                                                   
 Coordinates of enclosing tetrahedron are:                                      
          -0.25000D+05   -0.12500D+05   -0.12500D+05                            
           0.00000D+00   -0.12500D+05    0.37500D+05                            
           0.25000D+05   -0.12500D+05   -0.12500D+05                            
           0.00000D+00    0.37500D+05    0.00000D+00                            
 ntets=     32433     node index=     5000     nlstfail=       0 %done=  23.22  
 ntets=     62257     node index=    10000     nlstfail=       0 %done=  44.57  
 ntets=     91909     node index=    15000     nlstfail=       0 %done=  65.80  
 ntets=    118788     node index=    20000     nlstfail=       0 %done=  85.04  
 
 The mesh is now complete!                                                      
 
LaGriT FINISH: connect                                                          
 
cmo/setatt/MOTET/itetclr/1 0 0/1                                                
    127512 values reset for attribute itetclr                                   
 
resetpts/itp                                                                    
geniee                                                                          
finish                                                                          
#                                                                               
# Do the same for np1 mesh                                                      
#                                                                               
cmo/create/MOTET_np1                                                            
copypts/MOTET_np1/MOHEX_np1                                                     
copypts added nodes          1 to      94949                                    
cmo/select/MOTET_np1                                                            
filter 1 0 0                                                                    
FILTER:Use internal epsilonl value =   0.384592537277E-08                       
FILTER:Dudding duplicate points:           0                                    
rmpoint/compress                                                                
         0 points removed and          0 elements removed.                      
RMPOINT: new point count is        94949                                        
RMPOINT: new element count is          0                                        
cmo/setatt/MOTET_np1/imt/1 0 0/1                                                
Warning: nelements = 0                                                          
     94949 values reset for attribute imt1                                      
 
cmo/setatt/MOTET_np1/itp/1 0 0/0                                                
Warning: nelements = 0                                                          
     94949 values reset for attribute itp1                                      
 
#                                                                               
# See above                                                                     
#                                                                               
sort/MOTET_np1/index/ascending/ikey/xic yic zic                                 
cmo/addatt/MOTET_np1/ikey/vint/scalar/nnodes///gax/0                            
finish                                                                          
 SORT: order key written to attribute: ikey                                     
 
reorder/MOTET_np1/ikey                                                          
cmo/DELATT/MOTET_np1/ikey                                                       
#                                                                               
connect/noadd                                                                   
 Coordinates of enclosing tetrahedron are:                                      
          -0.25000D+05   -0.12500D+05   -0.12500D+05                            
           0.00000D+00   -0.12500D+05    0.37500D+05                            
           0.25000D+05   -0.12500D+05   -0.12500D+05                            
           0.00000D+00    0.37500D+05    0.00000D+00                            
 ntets=     32003     node index=     5000     nlstfail=       0 %done=   5.62  
 ntets=     65296     node index=    10000     nlstfail=       0 %done=  11.46  
 ntets=     98661     node index=    15000     nlstfail=       0 %done=  17.32  
 ntets=    130538     node index=    20000     nlstfail=       0 %done=  22.91  
 ntets=    161021     node index=    25000     nlstfail=       0 %done=  28.26  
 ntets=    190914     node index=    30000     nlstfail=       0 %done=  33.51  
 ntets=    220522     node index=    35000     nlstfail=       0 %done=  38.71  
 ntets=    250025     node index=    40000     nlstfail=       0 %done=  43.89  
 ntets=    279904     node index=    45000     nlstfail=       0 %done=  49.13  
 ntets=    309596     node index=    50000     nlstfail=       0 %done=  54.34  
 ntets=    338960     node index=    55000     nlstfail=       0 %done=  59.50  
 ntets=    368228     node index=    60000     nlstfail=       0 %done=  64.63  
 ntets=    397203     node index=    65000     nlstfail=       0 %done=  69.72  
 ntets=    426427     node index=    70000     nlstfail=       0 %done=  74.85  
 ntets=    455448     node index=    75000     nlstfail=       0 %done=  79.94  
 ntets=    484264     node index=    80000     nlstfail=       0 %done=  85.00  
 ntets=    507977     node index=    85000     nlstfail=       0 %done=  89.16  
 ntets=    530762     node index=    90000     nlstfail=       0 %done=  93.16  
 
 The mesh is now complete!                                                      
 
LaGriT FINISH: connect                                                          
 
cmo/setatt/MOTET_np1/itetclr/1 0 0/1                                            
    540506 values reset for attribute itetclr                                   
 
resetpts/itp                                                                    
geniee                                                                          
finish                                                                          
#                                                                               
finish                                                                          
#                                                                               
# Modify the hex data structure from a full octree data structure               
# to one in which only the highest level of refined hex is maintained           
# and all parent cells are stripped out of the data structure                   
#                                                                               
grid2grid/tree_to_fe/mohex2/MOHEX                                               
cmo/copy/mohex2/mohex                                                           
finish                                                                          
eltset/-parentset-/itetkid/gt/0                                                 
 
 THE ELTSET -parentset-                      HAS       2517 ELEMENTS            
finish                                                                          
rmpoint/element/eltset,get,-parentset-                                          
 Dudded      25877 points plus parents, and        2517 elements removed.       
finish                                                                          
rmpoint/compress                                                                
     25877 points removed and          0 elements removed.                      
RMPOINT: new point count is        23277                                        
RMPOINT: new element count is      18619                                        
finish                                                                          
resetpts/itp                                                                    
geniee                                                                          
finish                                                                          
finish                                                                          
eltset/-parentset-/delete                                                       
 
 ELTSET -parentset-                      DELETED                                
 
finish                                                                          
quality                                                                         
 
epsilonl, epsilonaspect:   3.8459254E-09  5.6885628E-26                         
--------------------------------------------                                    
elements with aspect ratio < .01:                    0                          
elements with aspect ratio b/w .01 and .02:          0                          
elements with aspect ratio b/w .02 and .05:          0                          
elements with aspect ratio b/w .05 and .1 :          0                          
elements with aspect ratio b/w .1  and .2 :          0                          
elements with aspect ratio b/w .2  and .5 :          0                          
elements with aspect ratio b/w .5  and 1. :      18619                          
min aspect ratio =  0.1000E+01  max aspect ratio =  0.1000E+01                  
 
epsilonvol:   2.2204460E-01                                                     
---------------------------------------                                         
element volumes b/w  0.1000E+07 and  0.3981E+07:         0                      
element volumes b/w  0.3981E+07 and  0.1585E+08:     16136                      
element volumes b/w  0.1585E+08 and  0.6310E+08:         0                      
element volumes b/w  0.6310E+08 and  0.2512E+09:      1983                      
element volumes b/w  0.2512E+09 and  0.1000E+10:       500                      
min volume =   1.0000000E+06  max volume =   1.0000000E+09                      
-----------------------------------------------------------                     
     18619 total elements evaluated.                                            
 
finish                                                                          
#dump / avs / octree_hex_mesh.inp / MOHEX                                       
#                                                                               
cmo/delete/MOHEX                                                                
     Released Mesh Object: mohex                                                
cmo/select/mohex2                                                               
#                                                                               
# Remove all but the most refined hex cells                                     
#                                                                               
loop/do/NTIMEs/0 N_OCTREE_REFINE_M1 1/loop_end infile remove_cells.mlgi         
LOOP: loop nesting level =     1                                                
define/NTIMEs/0                                                                 
finish                                                                          
infile remove_cells.mlgi                                                        
#                                                                               
# Remove cells from hex mesh based on the level of refinement                   
# itetlev is the refinement level. Original mesh itetlev=0                      
#                                                                               
eltset/edelete/itetlev/eq/NTIMEs                                                
 
 THE ELTSET edelete                          HAS        500 ELEMENTS            
rmpoint/element/eltset get edelete                                              
 Dudded        605 points plus parents, and         500 elements removed.       
eltset/edelete/release                                                          
 
Attribute release    not found in mesh object mohex2                            
 
rmpoint/compress                                                                
       605 points removed and          0 elements removed.                      
RMPOINT: new point count is        22672                                        
RMPOINT: new element count is      18119                                        
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/1                                                                 
finish                                                                          
infile remove_cells.mlgi                                                        
#                                                                               
# Remove cells from hex mesh based on the level of refinement                   
# itetlev is the refinement level. Original mesh itetlev=0                      
#                                                                               
eltset/edelete/itetlev/eq/NTIMEs                                                
 
 THE ELTSET edelete                          HAS       1983 ELEMENTS            
rmpoint/element/eltset get edelete                                              
 Dudded       1563 points plus parents, and        1983 elements removed.       
eltset/edelete/release                                                          
 
Attribute release    not found in mesh object mohex2                            
 
rmpoint/compress                                                                
      1563 points removed and          0 elements removed.                      
RMPOINT: new point count is        21109                                        
RMPOINT: new element count is      16136                                        
#                                                                               
finish                                                                          
finish                                                                          
define/NTIMEs/remove                                                            
finish                                                                          
#                                                                               
cmo/select/mohex2                                                               
cmo/DELATT/mohex2/if_int                                                        
intersect_elements/mohex2/MODFN/if_int                                          
cmo/select/mohex2                                                               
finish                                                                          
kdtree/build                                                                    
cmo/addatt//v2/INT/scalar/scalar/constant/temporary//2.0                        
finish                                                                          
cmo/addatt//linkt/VINT/v2/nelements//temporary/x/0.0                            
finish                                                                          
cmo/addatt//v12/INT/scalar/scalar/constant/temporary//12.0                      
finish                                                                          
cmo/addatt//sbox/VDOUBLE/v12/nelements/linear/temporary/x/0.0                   
finish                                                                          
finish                                                                          
cmo/addatt/mohex2/if_int/VINT/scalar/nelements/linear/permanent//0/             
finish                                                                          
 
         Element    Elems Searched  Elements Found  Percent Done                
             16            18766           6412        5 %                      
             31            18939             21       10 %                      
             46            19032              6       15 %                      
             61            19179              9       20 %                      
             76            19597             33       25 %                      
             91            19701             11       30 %                      
            106            19883             13       35 %                      
            121            20004             12       40 %                      
            136            20373             39       45 %                      
            151            20487             14       50 %                      
            166            20732             31       55 %                      
            181            21495            103       60 %                      
            196            21801             33       65 %                      
            211            21921             10       70 %                      
            226            22139             24       75 %                      
            241            22386             22       80 %                      
            256            22631             30       85 %                      
            271            22800             23       90 %                      
            286            23317             47       95 %                      
            298            30641           7735    Total Done                   
 
cmo/select/mohex2                                                               
finish                                                                          
kdtree/release                                                                  
cmo/DELATT/mohex2/sbox                                                          
finish                                                                          
cmo/DELATT/mohex2/v12                                                           
finish                                                                          
cmo/DELATT/mohex2/linkt                                                         
finish                                                                          
cmo/DELATT/mohex2/v2                                                            
finish                                                                          
finish                                                                          
cmo/select/mohex2                                                               
eltset/edelete/if_int/eq/0                                                      
 
 THE ELTSET edelete                          HAS       8401 ELEMENTS            
rmpoint/element/eltset get edelete                                              
 Dudded       8145 points plus parents, and        8401 elements removed.       
eltset/edelete/release                                                          
 
Attribute release    not found in mesh object mohex2                            
 
rmpoint/compress                                                                
      8145 points removed and          0 elements removed.                      
RMPOINT: new point count is        12964                                        
RMPOINT: new element count is       7735                                        
#                                                                               
dump/avs/mohex2.inp/mohex2                                                      
cmo/modatt/-def-/-def-/ioflag/x                                                 
finish                                                                          
dump/avs/MOTET_np1.inp/MOTET_np1                                                
cmo/modatt/-def-/-def-/ioflag/x                                                 
finish                                                                          
dump/avs/MOTET.inp/MOTET                                                        
cmo/modatt/-def-/-def-/ioflag/x                                                 
finish                                                                          
#                                                                               
cmo/select/MOTET                                                                
#                                                                               
#                                                                               
cmo/modatt/MOTET/itp/ioflag/l                                                   
cmo/modatt/MOTET/isn/ioflag/l                                                   
cmo/modatt/MOTET/icr/ioflag/l                                                   
# #                                                                             
define/ZONE/1                                                                   
define/FOUT/boundary_top                                                        
pset/top/attribute/zic/1 0 0/gt/ZMAX                                            
 
 THE PSET  top  HAS        561 POINTS                                           
pset/top/zone/FOUT/ascii/ZONE                                                   
PSET: THERE ARE  1 PSETS DEFINED                                                
  top                                                                           
PSET: Appended .zone to the file name                                           
PSET: OUTPUT top    1 PSETS TO FILE                                             
define/ZONE/2                                                                   
define/FOUT/boundary_bottom                                                     
pset/bottom/attribute/zic/1 0 0/lt/ZMIN                                         
 
 THE PSET  bottom  HAS        121 POINTS                                        
pset/bottom/zone/FOUT/ascii/ZONE                                                
PSET: THERE ARE  2 PSETS DEFINED                                                
  top               bottom                                                      
PSET: Appended .zone to the file name                                           
PSET: OUTPUT bottom    1 PSETS TO FILE                                          
define/ZONE/3                                                                   
define/FOUT/boundary_left_w                                                     
pset/left_w/attribute/xic/1 0 0/lt/XMIN                                         
 
 THE PSET  left_w  HAS        581 POINTS                                        
pset/left_w/zone/FOUT/ascii/ZONE                                                
PSET: THERE ARE  3 PSETS DEFINED                                                
  top               bottom            left_w                                    
PSET: Appended .zone to the file name                                           
PSET: OUTPUT left_w    1 PSETS TO FILE                                          
define/ZONE/4                                                                   
define/FOUT/boundary_front_n                                                    
pset/front_n/attribute/yic/1 0 0/gt/YMAX                                        
 
 THE PSET  front_n  HAS        591 POINTS                                       
pset/front_n/zone/FOUT/ascii/ZONE                                               
PSET: THERE ARE  4 PSETS DEFINED                                                
  top               bottom            left_w            front_n                 
PSET: Appended .zone to the file name                                           
PSET: OUTPUT front_n    1 PSETS TO FILE                                         
define/ZONE/5                                                                   
define/FOUT/boundary_right_e                                                    
pset/right_e/attribute/xic/1 0 0/gt/XMAX                                        
 
 THE PSET  right_e  HAS        629 POINTS                                       
pset/right_e/zone/FOUT/ascii/ZONE                                               
PSET: THERE ARE  5 PSETS DEFINED                                                
  top               bottom            left_w            front_n                 
  right_e                                                                       
PSET: Appended .zone to the file name                                           
PSET: OUTPUT right_e    1 PSETS TO FILE                                         
define/ZONE/6                                                                   
define/FOUT/boundary_back_s                                                     
pset/back_s/attribute/yic/1 0 0/lt/YMIN                                         
 
 THE PSET  back_s  HAS        599 POINTS                                        
pset/back_s/zone/FOUT/ascii/ZONE                                                
PSET: THERE ARE  6 PSETS DEFINED                                                
  top               bottom            left_w            front_n                 
  right_e           back_s                                                      
PSET: Appended .zone to the file name                                           
PSET: OUTPUT back_s    1 PSETS TO FILE                                          
trans/1 0 0/0. 0. 0./0,0,0                                                      
cmo/addatt/motet/transauto/VDOUBLE/scalar/vector/user/permanent/x/0.0           
finish                                                                          
Trans already complete, nothing done.                                           
dump/pflotran/full_mesh/MOTET/nofilter_zero                                     
 
*** Construct and Compress Sparse Matrix:3D ***                                 
   *** Compress Area Coefficient Values ***                                     
 
AMatbld3d_stor: Matrix compress_eps:  0.1000000E-07                             
AMatbld3d_stor: Local epsilon:  0.1000000E-14                                   
AMatbld3d_stor: *****Zero Negative Coefficients ******                          
AMatbld3d_stor: Number of 'zero' (< compress_eps) coefs         0               
AMatbld3d_stor: npoints =    23277  ncoefs =     184647                         
AMatbld3d_stor: Number of unique coefs =       122                              
AMatbld3d_stor: Maximum num. connections to a node =         39                 
PFLOTRAN total CELL nodes =        23277                                        
AMatbld3d_stor: Volume min =   3.9062500E+06                                    
AMatbld3d_stor: Volume max =   1.0000000E+09                                    
AMatbld3d_stor: Total Volume:   1.0000000E+12                                   
AMatbld3d_stor: abs(Aij/xij) min =   0.0000000E+00                              
AMatbld3d_stor: abs(Aij/xij) max =   1.0000000E+03                              
AMatbld3d_stor: (Aij/xij) max =   0.0000000E+00                                 
AMatbld3d_stor: (Aij/xij) min =  -1.0000000E+03                                 
PFLOTRAN will not filter zero coefs.                                            
PFLOTRAN coefficient from matbld Aij/Xij  max  =   0.0000000E+00                
PFLOTRAN total matbld matrix coefficients   =    184647                         
PFLOTRAN matrix  i>j (written)              =     80685                         
PFLOTRAN matrix  i<=j (not written)        =     103962                         
PFLOTRAN zero coefs < epsilon    (written)  =         0                         
 
PFLOTRAN total CONNECTIONS written         =      80685                         
PFLOTRAN coefficient  Aij min              =   1.9531250E+03                    
PFLOTRAN coefficient  Aij max              =   1.0000000E+06                    
AMatbld3d_stor Matrix coefficient values stored as scalar area/distance         
 
*** SPARSE COEFFICIENT MATRIX for PFLOTRAN SUCCESSFUL ***                       
 
3D Matrix Coefficient file written with name full_mesh.uge                      
 
dump/avs2/octree_dfn.inp/MOTET                                                  
cmo/modatt/-def-/-def-/ioflag/x                                                 
finish                                                                          
dump/coord/octree_dfn/MOTET                                                     
Writing FEHM coord/geom file: octree_dfn.fehm                                   
dump/stor/octree_dfn/MOTET                                                      
 
*** Construct and Compress Sparse Matrix:3D ***                                 
   *** Compress Area Coefficient Values ***                                     
 
AMatbld3d_stor: Matrix compress_eps:  0.1000000E-07                             
AMatbld3d_stor: Local epsilon:  0.1000000E-14                                   
AMatbld3d_stor: *****Zero Negative Coefficients ******                          
AMatbld3d_stor: Number of 'zero' (< compress_eps) coefs         0               
AMatbld3d_stor: npoints =    23277  ncoefs =     184647                         
AMatbld3d_stor: Number of unique coefs =       122                              
AMatbld3d_stor: Maximum num. connections to a node =         39                 
AMatbld3d_stor: Volume min =   3.9062500E+06                                    
AMatbld3d_stor: Volume max =   1.0000000E+09                                    
AMatbld3d_stor: Total Volume:   1.0000000E+12                                   
AMatbld3d_stor: abs(Aij/xij) min =   0.0000000E+00                              
AMatbld3d_stor: abs(Aij/xij) max =   1.0000000E+03                              
AMatbld3d_stor: (Aij/xij) max =   0.0000000E+00                                 
AMatbld3d_stor: (Aij/xij) min =  -1.0000000E+03                                 
AMatbld3d_stor Matrix coefficient values stored as scalar area/distance         
AMatbld3d_stor Matrix compression used for graph and coefficient values         
ascii STOR file written with name octree_dfn.stor                               
 
*** SPARSE COEFFICIENT MATRIX _astor SUCCESSFUL ***                             
 
3D Matrix Coefficient file written with name octree_dfn.stor                    
 
dump/zone_imt/octree_dfn/MOTET                                                  
*********dump_material_lists********                                            
Minimum material ID value =      1                                              
Maximum material ID value =      1                                              
Total possible materials  =      1                                              
Material           1 has     23277 nodes. #nodes/nnodes is    1.00000000000     
dump/zone_outside/octree_dfn/MOTET                                              
*********dump_outside_list********                                              
Voronoi Areas used for outside faces.                                           
 
assign_quadrant_id epsilon for zero:   1.0000000E-15                            
cmo/addatt/motet/top/vint/scalar/nnodes/linear/permanent/afgx/-5.0/             
finish                                                                          
Face top           1 has       561 nodes.                                       
top        Sum Voronoi      Area_x          Area_y          Area_z              
                       0.4687500E+07   0.4687500E+07   0.1000000E+09            
cmo/addatt/motet/bottom/vint/scalar/nnodes/linear/permanent/afgx/-5.0/          
finish                                                                          
Face bottom        2 has       121 nodes.                                       
bottom     Sum Voronoi      Area_x          Area_y          Area_z              
                       0.1000000E+08   0.1000000E+08   0.1000000E+09            
cmo/addatt/motet/left_w/vint/scalar/nnodes/linear/permanent/afgx/-5.0/          
finish                                                                          
Face left_w        3 has       581 nodes.                                       
left_w     Sum Voronoi      Area_x          Area_y          Area_z              
                       0.1000000E+09   0.6437500E+07   0.7500000E+07            
cmo/addatt/motet/right_e/vint/scalar/nnodes/linear/permanent/afgx/-5.0/         
finish                                                                          
Face right_e       5 has       629 nodes.                                       
right_e    Sum Voronoi      Area_x          Area_y          Area_z              
                       0.1000000E+09   0.6436198E+07   0.7500000E+07            
cmo/addatt/motet/back_n/vint/scalar/nnodes/linear/permanent/afgx/-5.0/          
finish                                                                          
Face back_n        6 has       591 nodes.                                       
back_n     Sum Voronoi      Area_x          Area_y          Area_z              
                       0.6437500E+07   0.1000000E+09   0.7500000E+07            
cmo/addatt/motet/front_s/vint/scalar/nnodes/linear/permanent/afgx/-5.0/         
finish                                                                          
Face front_s       4 has       599 nodes.                                       
front_s    Sum Voronoi      Area_x          Area_y          Area_z              
                       0.6437500E+07   0.1000000E+09   0.7500000E+07            
cmo/DELATT//top                                                                 
finish                                                                          
cmo/DELATT//bottom                                                              
finish                                                                          
cmo/DELATT//left_w                                                              
finish                                                                          
cmo/DELATT//right_e                                                             
finish                                                                          
cmo/DELATT//back_n                                                              
finish                                                                          
cmo/DELATT//front_s                                                             
finish                                                                          
finish                                                                          
LaGriT successfully completed                                                   
